# 图片水印工具

## 功能简介
- 图形界面工具，支持批量为图片添加自定义水印
- 支持三种水印类型：文本水印、图片水印、EXIF时间水印
- 实时预览水印效果，支持拖拽调整位置，所见即所得
- 完整的模板管理系统，保存、加载、导入导出水印配置
- 智能设置保存，程序启动自动恢复上次配置或默认模板

## 主要功能

### 文件处理
- **导入方式**：支持拖拽导入、文件选择器导入单张或多张图片、导入整个文件夹
- **支持格式**：JPEG、PNG、BMP、TIFF，支持PNG透明通道
- **导出选项**：自定义输出文件夹、文件命名规则（前缀/后缀）、图片质量和尺寸调整

### 水印设置
- **文本水印**：自定义文本内容、字体、大小、颜色、透明度、阴影/描边效果
- **图片水印**：支持导入Logo等图片作为水印，可调整大小、透明度、保持宽高比
- **EXIF时间水印**：自动提取图片拍摄时间，支持多种日期格式和前缀后缀
- **位置控制**：九宫格预设位置 + 实时拖拽调整，双向同步
- **实时预览**：所有调整立即在预览区域显示效果

### 模板管理系统
- **保存模板**：将当前所有水印设置（类型、参数、位置等）保存为可重用模板
- **加载模板**：快速应用已保存的水印配置
- **模板管理**：删除、重命名、设为默认模板
- **导入导出**：模板文件的导入导出，方便分享和备份
- **默认模板**：设置默认模板，程序启动时自动加载
- **自动保存**：程序关闭时自动保存当前设置，下次启动时恢复

## 系统要求
- 支持 Windows/macOS/Linux 操作系统
- Python 3.6 或更高版本
- 依赖库：Pillow, piexif (图像处理)，tkinter (GUI界面)

## 安装方法
```
# 创建虚拟环境（推荐）
python -m venv .venv
source .venv/bin/activate  # Linux/macOS
.venv\Scripts\activate     # Windows

# 安装依赖
pip install -r requirements.txt
```

## 使用方法
1. 启动程序：
   ```
   python src/main.py
   ```

2. **导入图片**：
   - 拖拽图片文件到导入区域
   - 点击"导入图片"按钮选择文件
   - 点击"导入文件夹"批量导入

3. **设置水印**：
   - 选择水印类型（文本/图片/EXIF时间）
   - 调整水印参数（大小、颜色、透明度等）
   - 使用九宫格选择位置或直接拖拽调整

4. **模板管理**：
   - 菜单"模板" → "保存模板"：保存当前设置
   - 菜单"模板" → "加载模板"：应用已保存的配置
   - 菜单"模板" → "管理模板"：进行模板管理

5. **导出图片**：
   - 设置输出文件夹和命名规则
   - 点击"导出所有图片"完成处理

## 命令行模式
除了图形界面外，也提供命令行模式用于批处理：
```
python exif_watermark.py <图片路径或目录> --size <small|medium|large> --color <white|black|red|blue|green> --pos <top-left|center|bottom-right>
```

示例：
```
python exif_watermark.py ./images --size large --color red --pos center
```

## 参数说明
- `--size`：水印字体大小（默认 medium）
- `--color`：水印颜色（默认 white）
- `--pos`：水印位置（默认 bottom-right）

## 结果说明
- 新图片保存在用户指定的输出目录，默认命名规则为原文件名加后缀
- 无EXIF拍摄时间的图片会提示用户并提供替代选项

## 兼容性
- 支持 JPG、JPEG、PNG、BMP、TIFF 格式
- 兼容 Windows/macOS/Linux

## 其他
- 如需扩展功能或遇到问题，请提交 issue
- 欢迎贡献代码，提交 pull request
